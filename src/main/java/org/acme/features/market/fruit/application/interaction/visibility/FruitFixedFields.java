package org.acme.features.market.fruit.application.interaction.visibility;

import java.util.LinkedHashSet;
import java.util.Optional;
import java.util.Set;
import java.util.stream.Stream;

import org.acme.common.action.Interaction;
import org.acme.features.market.fruit.domain.model.FruitRef;

import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.NonNull;
import lombok.ToString;
import lombok.experimental.SuperBuilder;

@Getter
@ToString
@SuperBuilder(toBuilder = true)
@EqualsAndHashCode(callSuper = true, onlyExplicitlyIncluded = true)
public class FruitFixedFields extends Interaction {

  /**
   * The list of fixed fields
   *
   * @autogenerated FixedFieldsGenerator
   */
  @NonNull
  private Set<String> fixed;

  /**
   * @autogenerated FixedFieldsGenerator
   */
  private FruitRef fruit;

  /**
   * Add another field to the fixed list
   *
   * @autogenerated FixedFieldsGenerator
   * @param field A field to add to fixed
   */
  public void add(final String field) {
    fixedEditable().add(field);
  }

  /**
   * The self instance to chain other calls
   *
   * @autogenerated FixedFieldsGenerator
   * @param field A field to add to fixed
   * @return The self instance to chain other calls
   */
  public FruitFixedFields and(final String field) {
    fixedEditable().add(field);
    return this;
  }

  /**
   * The iterable stream of fixed fields
   *
   * @autogenerated FixedFieldsGenerator
   * @return The iterable stream of fixed fields
   */
  public Stream<String> getFixed() {
    return fixed.stream();
  }

  /**
   * @autogenerated FixedFieldsGenerator
   * @return
   */
  public Optional<FruitRef> getFruit() {
    return Optional.ofNullable(fruit);
  }

  /**
   * The self instance to chain other calls
   *
   * @autogenerated FixedFieldsGenerator
   * @param field A field to remote from fixed
   * @return The self instance to chain other calls
   */
  public FruitFixedFields not(final String field) {
    fixedEditable().remove(field);
    return this;
  }

  /**
   * Remove one field from the fixed list
   *
   * @autogenerated FixedFieldsGenerator
   * @param field A field to remote from fixed
   */
  public void remove(final String field) {
    fixedEditable().remove(field);
  }

  /**
   * The list ensured as an editable list
   *
   * @autogenerated FixedFieldsGenerator
   * @return The list ensured as an editable list
   */
  private Set<String> fixedEditable() {
    if (!(fixed instanceof LinkedHashSet)) {
      fixed = new LinkedHashSet<>(fixed);
    }
    return fixed;
  }
}
