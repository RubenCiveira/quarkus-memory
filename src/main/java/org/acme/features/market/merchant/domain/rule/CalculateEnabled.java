package org.acme.features.market.merchant.domain.rule;

import java.util.Optional;
import java.util.Set;

import org.acme.features.market.merchant.domain.model.Merchant;
import org.acme.features.market.merchant.domain.model.Merchant.MerchantBuilder;
import org.acme.features.market.merchant.domain.model.rule.MerchantBuildFormulaPipeline;
import org.acme.features.market.merchant.domain.model.valueobject.MerchantEnabledVO;

import jakarta.enterprise.context.RequestScoped;

@RequestScoped
public class CalculateEnabled implements MerchantBuildFormulaPipeline {

  /**
   * @autogenerated FormulaEntityRuleImplGenerator
   * @param merchantBuilder
   * @param original
   * @return
   */
  @Override
  public MerchantBuilder calculate(final MerchantBuilder merchantBuilder,
      final Optional<Merchant> original) {
    return merchantBuilder.enabledValue(
        original.map(Merchant::getEnabled).map(MerchantEnabledVO::getValue).orElse(false));
  }

  /**
   * @autogenerated FormulaEntityRuleImplGenerator
   * @return
   */
  @Override
  public Set<String> fields() {
    return Set.of("enabled");
  }
}
