/* @autogenerated */
package org.acme.common.projection;

import java.util.List;
import java.util.Map;
import java.util.Optional;
import org.acme.common.connector.RemoteConnector;

import com.fasterxml.jackson.databind.ObjectMapper;

import jakarta.enterprise.context.ApplicationScoped;
import lombok.RequiredArgsConstructor;

@ApplicationScoped
@RequiredArgsConstructor
public class ProjectionRunner {
  private final ObjectMapper mapper;
  private final RemoteConnector connector;

  public Optional<Object> execute(ExecutionPlan plan, Map<String, String> params,
      Map<String, List<String>> headers) {
    return plan.getTree().byId( plan.getPath() ).map( node -> 
      plan.execute(node, connector, mapper, params, headers)
    );
  }
}
